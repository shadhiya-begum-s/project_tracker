<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Project Tracker</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    padding: 20px;
  }

  .container {
    max-width: 900px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }

  input, select, button {
    padding: 10px;
    margin: 8px 0;
    width: 100%;
    border: 1px solid #ccc;
    border-radius: 5px;
  }

  button {
    background: #007bff;
    color: white;
    border: none;
    cursor: pointer;
  }

  button:hover {
    background: #0056b3;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }

  th, td {
    border: 1px solid #ccc;
    padding: 10px;
    text-align: left;
  }

  th {
    background: #eaeaea;
  }

  .edit-btn {
    background: green;
    color: white;
    padding: 5px 10px;
    border: none;
    border-radius: 5px;
  }

  .delete-btn {
    background: red;
    color: white;
    padding: 5px 10px;
    border: none;
    border-radius: 5px;
  }

  .no-export {
    background: #fff3cd;
  }
</style>
</head>

<body>
<div class="container">
  <h2>Project Tracker</h2>

  <input type="text" id="domain" placeholder="Enter Domain">
  <input type="text" id="name" placeholder="Enter Name">
  <input type="text" id="register" placeholder="Enter Register Number">

  <select id="status">
    <option value="">Select Status</option>
    <option value="Completed">Completed</option>
    <option value="Ongoing">Ongoing</option>
  </select>

  <input type="number" id="year" placeholder="Enter Year">

  <button onclick="addProject()">Add / Update</button>

  <button onclick="exportTableToPDF()">Export PDF</button>
  <button onclick="exportTableToExcel()">Export Excel</button>

  <table id="projectTable">
    <thead>
      <tr>
        <th>S.No</th>
        <th>Domain</th>
        <th>Name</th>
        <th>Register No</th>
        <th>Status</th>
        <th>Year</th>
        <th class="no-export">Action</th>
      </tr>
    </thead>
    <tbody id="projectTableBody"></tbody>
  </table>
</div>

<!-- IMPORTANT SCRIPTS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

<script>
let editIndex = -1;
const tableBody = document.getElementById("projectTableBody");
let projectData = JSON.parse(localStorage.getItem("projectData")) || [];

// Refresh Table
function refreshTable() {
  tableBody.innerHTML = "";

  projectData.forEach((project, index) => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${index + 1}</td>
      <td>${project.domain}</td>
      <td>${project.name}</td>
      <td>${project.register}</td>
      <td>${project.status}</td>
      <td>${project.year}</td>
      <td class="no-export">
          <button class="edit-btn" onclick="editProject(${index})">Edit</button>
          <button class="delete-btn" onclick="deleteProject(${index})">Delete</button>
      </td>
    `;
    tableBody.appendChild(row);
  });
}

// Add or Update Project
function addProject() {
  const domain = document.getElementById("domain").value.trim();
  const name = document.getElementById("name").value.trim();
  const register = document.getElementById("register").value.trim();
  const status = document.getElementById("status").value;
  const year = document.getElementById("year").value;

  if (!domain || !name || !register || !status || !year) {
    alert("Please fill all fields.");
    return;
  }

  const project = { domain, name, register, status, year };

  if (editIndex === -1) {
    projectData.push(project);
  } else {
    projectData[editIndex] = project;
    editIndex = -1;
  }

  localStorage.setItem("projectData", JSON.stringify(projectData));
  refreshTable();
}

// Edit
function editProject(index) {
  const p = projectData[index];

  document.getElementById("domain").value = p.domain;
  document.getElementById("name").value = p.name;
  document.getElementById("register").value = p.register;
  document.getElementById("status").value = p.status;
  document.getElementById("year").value = p.year;

  editIndex = index;
}

// Delete
function deleteProject(index) {
  if (confirm("Are you sure?")) {
    projectData.splice(index, 1);
    localStorage.setItem("projectData", JSON.stringify(projectData));
    refreshTable();
  }
}

// Export PDF
function exportTableToPDF() {
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();

  const headers = ["S.No", "Domain", "Name", "Register No", "Status", "Year"];
  const rows = projectData.map((p, i) => [
    i + 1, p.domain, p.name, p.register, p.status, p.year
  ]);

  pdf.autoTable({
    head: [headers],
    body: rows
  });

  pdf.save("Project_Table.pdf");
}

// Export Excel
function exportTableToExcel() {
  const wb = XLSX.utils.book_new();

  const exportData = projectData.map((p, i) => ({
    "S.No": i + 1,
    Domain: p.domain,
    Name: p.name,
    "Register No": p.register,
    Status: p.status,
    Year: p.year
  }));

  const ws = XLSX.utils.json_to_sheet(exportData);
  XLSX.utils.book_append_sheet(wb, ws, "Projects");
  XLSX.writeFile(wb, "Project_Table.xlsx");
}

refreshTable();
</script>
</body>
</html>
