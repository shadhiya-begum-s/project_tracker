<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />  
  <title>Project Tracker</title>  
  
  <style>  
    body {  
      font-family: Arial, sans-serif;  
      background: #f4f4f4;  
      margin: 0;  
      padding: 20px;  
    }  
  
    .container {  
      max-width: 900px;  
      margin: auto;  
      background: #fff;  
      padding: 20px;  
      border-radius: 10px;  
      box-shadow: 0 0 10px rgba(0,0,0,0.1);  
    }  
  
    h2 { text-align: center; }  
    input, select, button {  
      width: 100%;  
      padding: 10px;  
      margin: 8px 0;  
      border-radius: 5px;  
      border: 1px solid #ccc;  
      box-sizing: border-box;  
    }  
  
    button { background: #007bff; color: white; border: none; cursor: pointer; }  
    button:hover { background: #0056b3; }  
  
    .export-buttons {  
      display: flex;  
      justify-content: space-between;  
      margin-top: 10px;  
    }  
    .export-buttons button {  
      width: 48%;  
      background: #28a745;  
    }  
    .export-buttons button:nth-child(2) {  
      background: #6f42c1;  
    }  
  
    .filters {  
      margin-top: 15px;  
      display: flex;  
      gap: 10px;  
      flex-wrap: wrap;  
    }  
    .filters select, .filters input {  
      flex: 1;  
      min-width: 150px;  
    }  
  
    .table-responsive {  
      width: 100%;  
      overflow-x: auto;  
      margin-top: 20px;  
    }  
  
    table {  
      width: 100%;  
      border-collapse: collapse;  
      min-width: 750px;  
    }  
  
    th, td {  
      border: 1px solid #ccc;  
      padding: 10px;  
      text-align: left;  
    }  
  
    th {  
      background: #007bff;  
      color: white;  
    }  
  
    .edit-btn { background: #28a745; color: white; padding: 6px 10px; border: none; cursor: pointer; }  
    .delete-btn { background: #dc3545; color: white; padding: 6px 10px; border: none; cursor: pointer; }  
  
    @media (max-width: 768px) {  
      input, select, button {  
        font-size: 14px;  
        padding: 8px;  
      }  
      table th, table td {  
        padding: 6px;  
        font-size: 13px;  
      }  
    }  
  
    @media (max-width: 480px) {  
      h2 { font-size: 20px; }  
      .filters { flex-direction: column; }  
      .export-buttons { flex-direction: column; }  
      .export-buttons button { width: 100%; margin-bottom: 8px; }  
    }  
  </style>  
</head>  
  
<body>  
  <div class="container">  
    <h2>Project Tracker</h2>  
  
    <input type="text" id="studentName" placeholder="Enter Name (Example: ALEXA A)">  
    <input type="text" id="regNo" placeholder="Enter Register Number (Example: U23CA000)">  
    <input type="text" id="classSection" placeholder="Enter Class & Section (Example: III BCA A)">  
    <input type="text" id="projectName" placeholder="Enter Project Name (Example: Smart Attendance)">  
    <input type="text" id="domainName" placeholder="Enter Domain Name (Example: Full Stack)">  
  
    <select id="status">  
      <option value="Not Started">Not Started</option>  
      <option value="In Progress">In Progress</option>  
      <option value="Completed">Completed</option>  
    </select>  
  
    <button onclick="addTask()">Add Entry</button>  
  
    <div class="export-buttons">  
      <button onclick="exportExcel()">Download Excel</button>  
      <button onclick="exportPDF()">Download PDF</button>  
    </div>  
  
    <h3>Search / Filter</h3>  
    <div class="filters">  
      <input type="text" id="searchBox" placeholder="Search by name, reg no, class, project..." onkeyup="renderTasks()">  
      <input type="text" id="filterDomain" placeholder="Filter by domain..." onkeyup="renderTasks()">  
      <select id="filterStatus" onchange="renderTasks()">  
        <option value="">All Status</option>  
        <option value="Not Started">Not Started</option>  
        <option value="In Progress">In Progress</option>  
        <option value="Completed">Completed</option>  
      </select>  
    </div>  
  
    <div class="table-responsive">  
      <table id="taskTable">  
        <thead>  
          <tr>  
            <th>Name</th>  
            <th>Reg No</th>  
            <th>Class & Section</th>  
            <th>Project Name</th>  
            <th>Domain</th>  
            <th>Status</th>  
            <th>Actions</th>  
          </tr>  
        </thead>  
        <tbody id="taskBody"></tbody>  
      </table>  
    </div>  
  </div>  
  
  <!-- Required Libraries -->  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>  
  
  <script>  
    let tasks = [];  
  
    window.onload = function () {  
      const saved = localStorage.getItem("tasks");  
      if (saved) {  
        tasks = JSON.parse(saved);  
        renderTasks();  
      }  
    };  
  
    function saveToLocal() {  
      localStorage.setItem("tasks", JSON.stringify(tasks));  
    }  
  
    function addTask() {  
      const studentName = document.getElementById('studentName').value;  
      const regNo = document.getElementById('regNo').value;  
      const classSection = document.getElementById('classSection').value;  
      const projectName = document.getElementById('projectName').value;  
      const domainName = document.getElementById('domainName').value;  
      const status = document.getElementById('status').value;  
  
      if (!studentName || !regNo || !classSection || !projectName || !domainName) {  
        alert('Please fill all fields');  
        return;  
      }  
  
      const newTask = {  
        id: Date.now(),  
        studentName,  
        regNo,  
        classSection,  
        projectName,  
        domainName,  
        status  
      };  
  
      tasks.push(newTask);  
      saveToLocal();  
      renderTasks();  
  
      document.getElementById('studentName').value = '';  
      document.getElementById('regNo').value = '';  
      document.getElementById('classSection').value = '';  
      document.getElementById('projectName').value = '';  
      document.getElementById('domainName').value = '';  
      document.getElementById('status').value = 'Not Started';  
    }  
  
    function renderTasks() {  
      let filtered = [...tasks];  
  
      const search = document.getElementById("searchBox").value.toLowerCase();  
      const filterDomain = document.getElementById("filterDomain").value.toLowerCase();  
      const filterStatus = document.getElementById("filterStatus").value;  
  
      if (search) {  
        filtered = filtered.filter(t =>  
          t.studentName.toLowerCase().includes(search) ||  
          t.regNo.toLowerCase().includes(search) ||  
          t.classSection.toLowerCase().includes(search) ||  
          t.projectName.toLowerCase().includes(search)  
        );  
      }  
  
      if (filterDomain) {  
        filtered = filtered.filter(t =>  
          t.domainName.toLowerCase().includes(filterDomain)  
        );  
      }  
  
      if (filterStatus) {  
        filtered = filtered.filter(t => t.status === filterStatus);  
      }  
  
      filtered.sort((a, b) => a.studentName.localeCompare(b.studentName));  
  
      const tableBody = document.getElementById('taskBody');  
      tableBody.innerHTML = '';  
  
      filtered.forEach(item => {  
        const row = `  
          <tr>  
            <td>${item.studentName}</td>  
            <td>${item.regNo}</td>  
            <td>${item.classSection}</td>  
            <td>${item.projectName}</td>  
            <td>${item.domainName}</td>  
            <td><strong>${item.status}</strong></td>  
            <td>  
              <button class="edit-btn" onclick="editTask(${item.id})">Edit</button>  
              <button class="delete-btn" onclick="deleteTask(${item.id})">Delete</button>  
            </td>  
          </tr>  
        `;  
        tableBody.innerHTML += row;  
      });  
    }  
  
    function deleteTask(id) {  
      tasks = tasks.filter(t => t.id !== id);  
      saveToLocal();  
      renderTasks();  
    }  
  
    function editTask(id) {  
      const item = tasks.find(t => t.id === id);  
      if (!item) return;  
  
      document.getElementById('studentName').value = item.studentName;  
      document.getElementById('regNo').value = item.regNo;  
      document.getElementById('classSection').value = item.classSection;  
      document.getElementById('projectName').value = item.projectName;  
      document.getElementById('domainName').value = item.domainName;  
      document.getElementById('status').value = item.status;  
  
      deleteTask(id);  
    }  
  
    /* --------------------------------------------------
       REMOVE ACTION COLUMN ONLY IN EXCEL EXPORT
    -------------------------------------------------- */
    function exportExcel() {
      const table = document.getElementById("taskTable");
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.table_to_sheet(table);

      // Remove last column (Actions)
      const range = XLSX.utils.decode_range(ws["!ref"]);
      for (let r = range.s.r; r <= range.e.r; r++) {
        const cell = XLSX.utils.encode_cell({ r: r, c: range.e.c });
        delete ws[cell];
      }
      range.e.c--;
      ws["!ref"] = XLSX.utils.encode_range(range);

      XLSX.utils.book_append_sheet(wb, ws, "Projects");
      XLSX.writeFile(wb, "Project_Tracker.xlsx");
    }

    /* --------------------------------------------------
       REMOVE ACTION COLUMN ONLY IN PDF EXPORT
    -------------------------------------------------- */
    async function exportPDF() {
      const table = document.querySelector("#taskTable");

      // Extract table without last Actions column
      const rows = [];
      table.querySelectorAll("tr").forEach(tr => {
        const cols = Array.from(tr.querySelectorAll("th, td"))
          .slice(0, -1)       // Remove last column
          .map(td => td.innerText);
        rows.push(cols);
      });

      const pdf = new jspdf.jsPDF();

      pdf.autoTable({
        head: [rows[0]],
        body: rows.slice(1)
      });

      pdf.save("Project_Tracker.pdf");
    }
  </script>  
</body>  
</html>
